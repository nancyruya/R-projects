> install.packages("spgwr")
also installing the dependencies ‘raster’, ‘sp’, ‘spData’

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/raster_3.0-12.tgz'
Content type 'application/x-gzip' length 4183540 bytes (4.0 MB)
==================================================
downloaded 4.0 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/sp_1.4-0.tgz'
Content type 'application/x-gzip' length 1883478 bytes (1.8 MB)
==================================================
downloaded 1.8 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/spData_0.3.3.tgz'
Content type 'application/x-gzip' length 3969433 bytes (3.8 MB)
==================================================
downloaded 3.8 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/spgwr_0.6-33.tgz'
Content type 'application/x-gzip' length 1944440 bytes (1.9 MB)
==================================================
downloaded 1.9 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//RtmpTYCNZN/downloaded_packages
> library(sp)
> library(spdep)
Error in library(spdep) : there is no package called ‘spdep’
> library(sf)
Error in library(sf) : there is no package called ‘sf’
> library(tmap)
Error in library(tmap) : there is no package called ‘tmap’
> 
> install.packages("sp")
Error in install.packages : Updating loaded packages

Restarting R session...

> install.packages("sp")
trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/sp_1.4-0.tgz'
Content type 'application/x-gzip' length 1883478 bytes (1.8 MB)
==================================================
downloaded 1.8 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmp17vXg8/downloaded_packages
> install.packages("sf")
also installing the dependencies ‘e1071’, ‘classInt’, ‘DBI’, ‘units’

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/e1071_1.7-3.tgz'
Content type 'application/x-gzip' length 900756 bytes (879 KB)
==================================================
downloaded 879 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/classInt_0.4-2.tgz'
Content type 'application/x-gzip' length 78133 bytes (76 KB)
==================================================
downloaded 76 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/DBI_1.1.0.tgz'
Content type 'application/x-gzip' length 586234 bytes (572 KB)
==================================================
downloaded 572 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/units_0.6-5.tgz'
Content type 'application/x-gzip' length 1321560 bytes (1.3 MB)
==================================================
downloaded 1.3 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/sf_0.8-1.tgz'
Content type 'application/x-gzip' length 64283240 bytes (61.3 MB)
==================================================
downloaded 61.3 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmp17vXg8/downloaded_packages
> library(sp)
> library(spdep)
Error in library(spdep) : there is no package called ‘spdep’
> library(sf)
Linking to GEOS 3.7.2, GDAL 2.4.2, PROJ 5.2.0
> library(tmap)
Error in library(tmap) : there is no package called ‘tmap’
> install.packages("spdep")
also installing the dependencies ‘gtools’, ‘gdata’, ‘deldir’, ‘LearnBayes’, ‘coda’, ‘expm’, ‘gmodels’

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/gtools_3.8.1.tgz'
Content type 'application/x-gzip' length 318769 bytes (311 KB)
==================================================
downloaded 311 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/gdata_2.18.0.tgz'
Content type 'application/x-gzip' length 1223792 bytes (1.2 MB)
==================================================
downloaded 1.2 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/deldir_0.1-25.tgz'
Content type 'application/x-gzip' length 264810 bytes (258 KB)
==================================================
downloaded 258 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/LearnBayes_2.15.1.tgz'
Content type 'application/x-gzip' length 1023393 bytes (999 KB)
==================================================
downloaded 999 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/coda_0.19-3.tgz'
Content type 'application/x-gzip' length 326688 bytes (319 KB)
==================================================
downloaded 319 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/expm_0.999-4.tgz'
Content type 'application/x-gzip' length 238238 bytes (232 KB)
==================================================
downloaded 232 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/gmodels_2.18.1.tgz'
Content type 'application/x-gzip' length 113492 bytes (110 KB)
==================================================
downloaded 110 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/spdep_1.1-3.tgz'
Content type 'application/x-gzip' length 2576491 bytes (2.5 MB)
==================================================
downloaded 2.5 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmp17vXg8/downloaded_packages
> install.packages("tmap")
also installing the dependencies ‘gridExtra’, ‘rgdal’, ‘rgeos’, ‘dichromat’, ‘XML’, ‘png’, ‘viridis’, ‘leaflet.providers’, ‘tmaptools’, ‘lwgeom’, ‘leaflet’, ‘leafsync’

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/gridExtra_2.3.tgz'
Content type 'application/x-gzip' length 1103470 bytes (1.1 MB)
==================================================
downloaded 1.1 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/rgdal_1.4-8.tgz'
Content type 'application/x-gzip' length 49274581 bytes (47.0 MB)
==================================================
downloaded 47.0 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/rgeos_0.5-2.tgz'
Content type 'application/x-gzip' length 7145701 bytes (6.8 MB)
==================================================
downloaded 6.8 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/dichromat_2.0-0.tgz'
Content type 'application/x-gzip' length 146850 bytes (143 KB)
==================================================
downloaded 143 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/XML_3.99-0.3.tgz'
Content type 'application/x-gzip' length 1842962 bytes (1.8 MB)
==================================================
downloaded 1.8 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/png_0.1-7.tgz'
Content type 'application/x-gzip' length 354111 bytes (345 KB)
==================================================
downloaded 345 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/viridis_0.5.1.tgz'
Content type 'application/x-gzip' length 1866383 bytes (1.8 MB)
==================================================
downloaded 1.8 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/leaflet.providers_1.9.0.tgz'
Content type 'application/x-gzip' length 47465 bytes (46 KB)
==================================================
downloaded 46 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/tmaptools_2.0-2.tgz'
Content type 'application/x-gzip' length 351535 bytes (343 KB)
==================================================
downloaded 343 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/lwgeom_0.2-1.tgz'
Content type 'application/x-gzip' length 8416245 bytes (8.0 MB)
==================================================
downloaded 8.0 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/leaflet_2.0.3.tgz'
Content type 'application/x-gzip' length 2319528 bytes (2.2 MB)
==================================================
downloaded 2.2 MB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/leafsync_0.1.0.tgz'
Content type 'application/x-gzip' length 843928 bytes (824 KB)
==================================================
downloaded 824 KB

trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/tmap_2.3-2.tgz'
Content type 'application/x-gzip' length 3515244 bytes (3.4 MB)
==================================================
downloaded 3.4 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmp17vXg8/downloaded_packages
> library(sp)
> library(spdep)
Loading required package: spData
To access larger datasets in this package, install the spDataLarge package
with: `install.packages('spDataLarge', repos='https://nowosad.github.io/drat/',
type='source')`
> library(sf)
> library(tmap)
> 
> install.packages('spDataLarge', repos='https://nowosad.github.io/drat/',
+                  type='source')
trying URL 'https://nowosad.github.io/drat/src/contrib/spDataLarge_0.3.1.tar.gz'
Content type 'application/gzip' length 25561224 bytes (24.4 MB)
==================================================
downloaded 24.4 MB

* installing *source* package ‘spDataLarge’ ...
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (spDataLarge)

The downloaded source packages are in
	‘/private/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T/Rtmp17vXg8/downloaded_packages’
> library(sp)
> library(spdep)
> library(sf)
> library(tmap)
> setwd("insert your pathway here")
Error in setwd("insert your pathway here") : 
  cannot change working directory
> download.file(url = "https://raw.githubusercontent.com/crd230/data/master/phil_tracts.zip", destfile = "phil_tracts.zip")
trying URL 'https://raw.githubusercontent.com/crd230/data/master/phil_tracts.zip'
Content type 'application/zip' length 384678 bytes (375 KB)
==================================================
downloaded 375 KB

> unzip(zipfile = "phil_tracts.zip")
> 
> philly <- st_read("phil_tracts.shp")
Reading layer `phil_tracts' from data source `/Users/ruyazhang/phil_tracts.shp' using driver `ESRI Shapefile'
Simple feature collection with 376 features and 25 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: 476461.9 ymin: 4413070 xmax: 503772 ymax: 4443067
epsg (SRID):    NA
proj4string:    +proj=utm +zone=18 +ellps=GRS80 +units=m +no_defs
> 
> fit.ols<-glm(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + lmhval + 
+                  phnew + phisp, data = philly) 
> summary(fit.ols)

Call:
glm(formula = usarea ~ lmhhinc + lpop + pnhblk + punemp + pvac + 
    ph70 + lmhval + phnew + phisp, data = philly)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-177.24   -34.81    -9.91    23.03   670.17  

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  534.491    164.270   3.254  0.00124 ** 
lmhhinc        2.462     12.176   0.202  0.83990    
lpop          -1.344      6.338  -0.212  0.83216    
pnhblk        21.158     18.077   1.170  0.24260    
punemp        -5.097     63.645  -0.080  0.93622    
pvac         371.699     58.427   6.362 5.96e-10 ***
ph70         -79.691     35.535  -2.243  0.02552 *  
lmhval       -45.668     10.458  -4.367 1.64e-05 ***
phnew         17.958    319.042   0.056  0.95514    
phisp        -56.308     30.695  -1.834  0.06741 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 4829.927)

    Null deviance: 2938287  on 375  degrees of freedom
Residual deviance: 1767753  on 366  degrees of freedom
AIC: 4268.4

Number of Fisher Scoring iterations: 2

> library(spgwr)
NOTE: This package does not constitute approval of GWR
as a method of spatial analysis; see example(gwr)
> install.packages("spgwr")
Error in install.packages : Updating loaded packages

Restarting R session...

> install.packages("spgwr")
trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/spgwr_0.6-33.tgz'
Content type 'application/x-gzip' length 1944440 bytes (1.9 MB)
==================================================
downloaded 1.9 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmpxz6leD/downloaded_packages
> library(spgwr)
Loading required package: sp
Loading required package: spData
NOTE: This package does not constitute approval of GWR
as a method of spatial analysis; see example(gwr)
> philly.sp <- as(philly, "Spatial")
Error in as(philly, "Spatial") : 
  no method or default for coercing “sf” to “Spatial”
> setwd("/Users/ruyazhang/downloads/phil_tracts")
> philly <- st_read("phil_tracts.shp")
Error in st_read("phil_tracts.shp") : could not find function "st_read"
> 
> install.packages("sf")
trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/sf_0.8-1.tgz'
Content type 'application/x-gzip' length 64283240 bytes (61.3 MB)
==================================================
downloaded 61.3 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmpxz6leD/downloaded_packages
> library(sf)
Linking to GEOS 3.7.2, GDAL 2.4.2, PROJ 5.2.0
> setwd("/Users/ruyazhang/downloads/phil_tracts")philly <- st_read("phil_tracts.shp")
Error: unexpected symbol in "setwd("/Users/ruyazhang/downloads/phil_tracts")philly"
> setwd("/Users/ruyazhang/downloads/phil_tracts")
> philly <- st_read("phil_tracts.shp")
Reading layer `phil_tracts' from data source `/Users/ruyazhang/Downloads/phil_tracts/phil_tracts.shp' using driver `ESRI Shapefile'
Simple feature collection with 376 features and 25 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: 476461.9 ymin: 4413070 xmax: 503772 ymax: 4443067
epsg (SRID):    NA
proj4string:    +proj=utm +zone=18 +ellps=GRS80 +units=m +no_defs
> library(spgwr)
> philly.sp <- as(philly, "Spatial")
> gwr.b1<-gwr.sel(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + 
+                     lmhval + phnew + phisp, philly.sp)
Bandwidth: 14224.76 CV score: 1845565 
Bandwidth: 22993.17 CV score: 1860162 
Bandwidth: 8805.59 CV score: 1818722 
Bandwidth: 5456.356 CV score: 1750890 
Bandwidth: 3386.415 CV score: 1610987 
Bandwidth: 2107.121 CV score: 1497008 
Bandwidth: 1316.474 CV score: 1412725 
Bandwidth: 827.8277 CV score: 1787166 
Bandwidth: 1618.475 CV score: 1446078 
Bandwidth: 1129.828 CV score: 1448167 
Bandwidth: 1377.629 CV score: 1414671 
Bandwidth: 1298.316 CV score: 1413143 
Bandwidth: 1324.036 CV score: 1412698 
Bandwidth: 1322.62 CV score: 1412697 
Bandwidth: 1322.714 CV score: 1412696 
Bandwidth: 1322.708 CV score: 1412696 
Bandwidth: 1322.708 CV score: 1412696 
Bandwidth: 1322.708 CV score: 1412696 
Bandwidth: 1322.708 CV score: 1412696 
> gwr.b1
[1] 1322.708
> gwr.fit1<-gwr(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + lmhval + 
+                   phnew + phisp, data = philly.sp, bandwidth = gwr.b1, se.fit=T, hatmatrix=T)
> gwr.fit1
Call:
gwr(formula = usarea ~ lmhhinc + lpop + pnhblk + punemp + pvac + 
    ph70 + lmhval + phnew + phisp, data = philly.sp, bandwidth = gwr.b1, 
    hatmatrix = T, se.fit = T)
Kernel function: gwr.Gauss 
Fixed bandwidth: 1322.708 
Summary of GWR coefficient estimates at data points:
                   Min.    1st Qu.     Median    3rd Qu.       Max.   Global
X.Intercept. -1574.4098   -53.8875    88.4952   472.7282  3092.1466 534.4908
lmhhinc       -151.0306    -7.0538     3.2205    22.3099   120.2753   2.4616
lpop           -76.6700     1.1576     7.2067    20.4788   109.5747  -1.3441
pnhblk        -124.9781    -2.0948    44.5163   100.0885   490.8730  21.1576
punemp        -627.4200  -150.5909   -17.8892    69.6271   752.1507  -5.0966
pvac         -1329.2458     2.5473   165.4452   343.9353  1108.9034 371.6993
ph70         -1028.8902  -161.7810   -43.4011    -8.2491   144.6265 -79.6910
lmhval        -178.5925   -70.3725   -26.7389    -3.7657    89.1748 -45.6676
phnew        -3747.6137  -484.6544    54.6557   734.6135  6434.5611  17.9575
phisp         -313.3416   -24.9975     4.8295   117.2091  1533.6439 -56.3076
Number of data points: 376 
Effective number of parameters (residual: 2traceS - traceS'S): 220.8092 
Effective degrees of freedom (residual: 2traceS - traceS'S): 155.1908 
Sigma (residual: 2traceS - traceS'S): 59.06332 
Effective number of parameters (model: traceS): 178.5045 
Effective degrees of freedom (model: traceS): 197.4955 
Sigma (model: traceS): 52.3567 
Sigma (ML): 37.9452 
AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 4491.91 
AIC (GWR p. 96, eq. 4.22): 3979.926 
Residual sum of squares: 541379.3 
Quasi-global R2: 0.81575 
> gwr.b2<-gwr.sel(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + lmhval + 
+                     phnew + phisp, data = philly.sp, gweight = gwr.bisquare)
Bandwidth: 14224.76 CV score: 1797387 
Bandwidth: 22993.17 CV score: 1840913 
Bandwidth: 8805.59 CV score: 1634064 
Bandwidth: 5456.356 CV score: 1578492 
Bandwidth: 1760.637 CV score: NA 
Bandwidth: 4044.717 CV score: NA 
Bandwidth: 6735.649 CV score: 1585951 
Bandwidth: 5535.278 CV score: 1581610 
Bandwidth: 4917.158 CV score: NA 
Bandwidth: 5250.4 CV score: 1569337 
Bandwidth: 5123.113 CV score: 1563084 
Bandwidth: 5044.445 CV score: NA 
Bandwidth: 5171.732 CV score: 1565614 
Bandwidth: 5093.064 CV score: 1561374 
Bandwidth: 5074.493 CV score: NA 
Bandwidth: 5104.542 CV score: 1562042 
Bandwidth: 5085.971 CV score: NA 
Bandwidth: 5097.448 CV score: 1561631 
Bandwidth: 5090.355 CV score: NA 
Bandwidth: 5094.739 CV score: 1561473 
Bandwidth: 5092.029 CV score: NA 
Bandwidth: 5093.704 CV score: 1561412 
Bandwidth: 5092.669 CV score: NA 
Bandwidth: 5093.309 CV score: 1561389 
Bandwidth: 5092.913 CV score: 1561365 
Bandwidth: 5092.82 CV score: NA 
Bandwidth: 5092.971 CV score: 1561369 
Bandwidth: 5092.878 CV score: NA 
Bandwidth: 5092.935 CV score: 1561367 
Bandwidth: 5092.9 CV score: 1561365 
Bandwidth: 5092.891 CV score: NA 
Bandwidth: 5092.905 CV score: 1561365 
Bandwidth: 5092.897 CV score: NA 
Bandwidth: 5092.902 CV score: 1561365 
Bandwidth: 5092.899 CV score: 1561365 
Bandwidth: 5092.898 CV score: 1561364 
Bandwidth: 5092.897 CV score: NA 
Bandwidth: 5092.898 CV score: 1561365 
Bandwidth: 5092.898 CV score: 1561364 
Bandwidth: 5092.898 CV score: NA 
Bandwidth: 5092.898 CV score: 1561364 
There were 15 warnings (use warnings() to see them)
> 
> gwr.fit2<-gwr(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + lmhval + 
+                   phnew + phisp, data = philly.sp, bandwidth = gwr.b2, gweight = gwr.bisquare, se.fit=T, 
+               hatmatrix=T)
> gwr.b2
[1] 5092.898
> gwr.fit2
Call:
gwr(formula = usarea ~ lmhhinc + lpop + pnhblk + punemp + pvac + 
    ph70 + lmhval + phnew + phisp, data = philly.sp, bandwidth = gwr.b2, 
    gweight = gwr.bisquare, hatmatrix = T, se.fit = T)
Kernel function: gwr.bisquare 
Fixed bandwidth: 5092.898 
Summary of GWR coefficient estimates at data points:
                   Min.    1st Qu.     Median    3rd Qu.       Max.   Global
X.Intercept.  -649.3890    -5.7699   134.6249   512.9574  2336.5957 534.4908
lmhhinc       -180.3145    -4.4545     1.7487    13.7554    68.2914   2.4616
lpop           -49.1608     1.2314     6.3430    19.0823    69.7005  -1.3441
pnhblk        -106.4233     1.3658    41.0256    96.5291   285.2134  21.1576
punemp        -397.5988  -143.8982    -6.2685    57.4553   729.4700  -5.0966
pvac          -757.5534     8.8245   209.8576   370.7793   650.3669 371.6993
ph70          -643.0070  -207.9799   -66.3040   -19.8028   142.9682 -79.6910
lmhval        -150.2726   -69.5496   -34.8198    -6.7118   107.7625 -45.6676
phnew        -1844.6086  -418.1211    19.6153   509.9117  7421.2055  17.9575
phisp         -221.0604   -26.5670    -7.5865    84.2566  1418.3152 -56.3076
Number of data points: 376 
Effective number of parameters (residual: 2traceS - traceS'S): 132.4964 
Effective degrees of freedom (residual: 2traceS - traceS'S): 243.5036 
Sigma (residual: 2traceS - traceS'S): 62.2312 
Effective number of parameters (model: traceS): 107.6713 
Effective degrees of freedom (model: traceS): 268.3287 
Sigma (model: traceS): 59.2826 
Sigma (ML): 50.0803 
AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 4316.932 
AIC (GWR p. 96, eq. 4.22): 4117.761 
Residual sum of squares: 943021.6 
Quasi-global R2: 0.6790573 
> gwr.b3<-gwr.sel(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + 
+                     lmhval + phnew + phisp, data = philly.sp, adapt = TRUE)
Adaptive q: 0.381966 CV score: 1785033 
Adaptive q: 0.618034 CV score: 1814714 
Adaptive q: 0.236068 CV score: 1733969 
Adaptive q: 0.145898 CV score: 1650907 
Adaptive q: 0.09016994 CV score: 1565518 
Adaptive q: 0.05572809 CV score: 1471615 
Adaptive q: 0.03444185 CV score: 1401939 
Adaptive q: 0.02128624 CV score: 1384273 
Adaptive q: 0.01588534 CV score: 1431365 
Adaptive q: 0.02662582 CV score: 1380970 
Adaptive q: 0.02518866 CV score: 1380056 
Adaptive q: 0.02491844 CV score: 1380031 
Adaptive q: 0.02487775 CV score: 1380032 
Adaptive q: 0.02495914 CV score: 1380032 
Adaptive q: 0.02491844 CV score: 1380031 
> gwr.b3
[1] 0.02491844
> gwr.fit3<-gwr(usarea ~ lmhhinc   + lpop + pnhblk + punemp + pvac  + ph70 + lmhval + 
+                   phnew + phisp, data = philly.sp, adapt=gwr.b3, se.fit=T, hatmatrix=T)
> 
> gwr.fit3
Call:
gwr(formula = usarea ~ lmhhinc + lpop + pnhblk + punemp + pvac + 
    ph70 + lmhval + phnew + phisp, data = philly.sp, adapt = gwr.b3, 
    hatmatrix = T, se.fit = T)
Kernel function: gwr.Gauss 
Adaptive quantile: 0.02491844 (about 9 of 376 data points)
Summary of GWR coefficient estimates at data points:
                    Min.     1st Qu.      Median     3rd Qu.        Max.   Global
X.Intercept. -1413.25718     2.04814   150.67770   593.38119  2856.09861 534.4908
lmhhinc        -77.30238    -6.62505     2.08877    20.59832   121.03243   2.4616
lpop           -71.53993     0.32328     6.55222    19.42020    93.59455  -1.3441
pnhblk        -139.33868    -0.35274    39.43998   102.07286   462.87992  21.1576
punemp        -592.27650  -109.64202    -3.93096    63.56270   623.38186  -5.0966
pvac         -1410.12965    11.95427   193.34738   350.39251  1047.77143 371.6993
ph70          -975.65611  -190.62161   -67.38336   -13.17506   137.47857 -79.6910
lmhval        -185.48730   -73.39044   -36.70912    -7.56967    48.91389 -45.6676
phnew        -2570.54553  -577.37945    29.21937   654.40082  4045.23829  17.9575
phisp         -182.91660   -29.72723    -7.23980    65.71058   771.29484 -56.3076
Number of data points: 376 
Effective number of parameters (residual: 2traceS - traceS'S): 177.8408 
Effective degrees of freedom (residual: 2traceS - traceS'S): 198.1592 
Sigma (residual: 2traceS - traceS'S): 54.21695 
Effective number of parameters (model: traceS): 135.2358 
Effective degrees of freedom (model: traceS): 240.7642 
Sigma (model: traceS): 49.18654 
Sigma (ML): 39.35938 
AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 4258.02 
AIC (GWR p. 96, eq. 4.22): 3964.174 
Residual sum of squares: 582484.4 
Quasi-global R2: 0.8017605 
> gwr.fit1$bandwidth
[1] 1322.708
> gwr.fit3$bandwidth
  [1] 1149.6960 1183.1752 1326.2045 1172.4310 1080.9776 1080.4400 1253.3075 1618.3852
  [9] 1933.3755 1317.3601 1250.3552 1297.9878 1206.6260 1237.7607 1348.3389 1161.8085
 [17] 1094.2641 1262.8032 1679.6423 1668.6594 1449.5608 1377.3837 1460.3981 1239.4362
 [25] 1284.6018 1494.5331 1404.9279 1347.7279 1569.7716 1713.0538 1126.3074  936.9146
 [33]  885.2005 1037.1643 1094.9965  951.7536 1024.4739 1206.9699 1038.2901  966.2943
 [41]  987.5778  937.3304 1161.6782 1015.1787 1000.2734 4929.8934 2912.4102 3427.6077
 [49] 2497.9841 2180.7579 2041.0962 2247.6751 1531.2191 1399.2416 1167.3991 1281.4852
 [57] 1147.1804 1203.5498 1219.8614 1480.6902 1395.4648 1424.8599 1753.3825 1443.1328
 [65] 1258.2813 1448.0626 1522.8533 1377.6613 1644.8620 1445.4104 1263.7606 1260.3937
 [73] 1273.1631 1210.8011 1202.9345 1264.6042 1202.4543 1027.8557 1491.4673 1250.6009
 [81] 2104.3717 1944.9710 1903.3906 2113.4772 1930.2247 1800.0350 1895.7397 2356.5608
 [89] 2273.4443 2507.9185 1433.7533 1522.7432 1623.1450 1485.4180 1521.6495 1445.0000
 [97] 1455.7156 1548.0717 1484.3209 1517.3800 1674.9190 1627.1831 1600.2474 1761.9482
[105] 1461.7746 1375.5426 1344.3843 1345.1753 1543.3719 1498.2537 1495.3136 1685.1020
[113] 1640.5623 1687.7274 1801.9435 1667.9202 1797.8396 1861.2456 1792.4967 1848.9709
[121] 1765.1738 2487.6310 2028.3775 2777.8273 2726.9368 2085.7093 2749.1080 2148.2730
[129] 2068.6457 1624.7288 1415.1939 3580.3917 3317.2191 1741.6830 2378.0338 2059.9268
[137] 3242.7861 1577.6733 1325.4036 1352.8377 1157.3042  915.1007  953.6252 1164.6167
[145] 2590.0996 2248.3944 1282.1087 2238.4517 2300.8338  863.4088  898.4611  848.7930
[153] 1366.5018 1462.4520 1299.8048 1309.0455 1509.1945 1517.7368 1542.2995 1336.0976
[161] 1369.7717 1723.8893 1737.3518 1805.6483 1991.9663 1446.8963 1811.0270 1887.9420
[169] 2749.8621 1812.7160 1204.4508 1560.6511 3137.4233 2860.0573 2995.4353 2649.7392
[177] 1632.1079 1269.1912 3977.7382 1113.0079 1227.6887 1266.9417 2084.1229 1760.0500
[185] 1721.3045 2382.1732 3152.5118 1156.6920 1195.2937 1144.2137  913.7131  889.4278
[193]  938.7811 1225.6714 1691.2698 1683.5002 1142.8835 1347.4642  997.7492 1328.6705
[201] 1422.4118 1062.5272 1270.5024 1502.9227 1323.8170 1060.8398 1091.3630 1757.2854
[209] 1266.7186 1559.6225 1090.8856 1173.5343 1451.4422 1223.2996  996.5115 1182.3345
[217] 1768.5657 1784.1195 1373.5698 1439.4176 1148.8977 1443.8581 1292.8810 1174.2284
[225] 1616.1746 2145.3811 1629.4297 1969.2547 2252.2645 2372.0125 1203.3670 1255.6972
[233] 1227.9477 1098.4566 1055.0571 1481.5491 1760.7239 1778.0384 1168.1166 1125.1907
[241] 1256.6905 1330.0300 1585.8025 2497.3748 2746.0348 1509.3036 1931.8575 2627.5873
[249] 3017.1983 3781.5675 2010.8207 2197.9499 2059.7430 1813.8544 1729.5140 1588.6780
[257] 1651.7633 1477.1388 1970.6281 1727.7785 2089.6800 1960.2473 1495.3766 1435.0412
[265] 2207.3149 1856.5329 1460.4975 1456.0199 1805.9800 1427.5722 1597.3591 1666.3611
[273] 1528.8778 1776.4450 1570.7058 1829.3064 1927.5048 1761.8633 1449.8676 1516.1387
[281] 1518.9827 1241.1781 1470.8321 1521.9097 3655.6712 1987.0742 2224.5394 2241.0749
[289] 3449.9692 2855.8109 2788.3023 1740.6684  923.3570  915.2436 1061.4771  952.3694
[297] 3232.3931 1317.5031  991.8756  998.7429  969.8376 1079.1369 2010.8536 1986.9894
[305] 1535.4527 1593.9031 1462.7244 1159.8429 1207.2627 1455.2354 1484.5447 1267.8352
[313] 1231.6060 1268.5112 1066.8641 1110.6200 1250.7819 1096.2617 1887.6722 1745.3567
[321] 1344.4359 2413.6404 2752.6523 1272.9689  939.6277 1085.8393  825.8420 1345.9480
[329] 1106.3061 3364.2918 1613.1166 1273.4573 2140.7797 2778.9098 3267.8459 1745.7554
[337] 1464.1753 1794.8908 1403.0026 1565.3360 1581.6820 1519.9556 1312.1269 1406.8640
[345] 1474.6692 1429.8799 1436.3432 1371.3166 1249.1307 1531.4984 1433.9176 1463.0054
[353] 1716.8105 1759.2807 1654.2402 1605.6215 2944.9500 2050.0637 1910.5561 1643.7374
[361] 2553.3518 3397.2850 2548.2420 2559.1329 2823.3119 3040.4003 2753.9114 2920.7425
[369] 3122.3298 1273.1214 2554.0051 1776.5060 1582.0286 1508.4337 2528.0667 1066.8106
> philly$bwadapt <- gwr.fit3$bandwidth
> 
> tm_shape(philly, unit = "mi") +
+     tm_polygons(col = "bwadapt", style = "quantile",palette = "Reds", 
+                 border.alpha = 0, title = "") +
+     tm_scale_bar(breaks = c(0, 1, 2), size = 1, position = c("right", "bottom")) +
+     tm_compass(type = "4star", position = c("left", "top")) + 
+     tm_layout(main.title = "GWR bandwidth",  main.title.size = 0.95, frame = FALSE, legend.outside = TRUE)
Error in tm_shape(philly, unit = "mi") : 
  could not find function "tm_shape"
> install.packages("tmap")
trying URL 'https://cran.rstudio.com/bin/macosx/el-capitan/contrib/3.6/tmap_2.3-2.tgz'
Content type 'application/x-gzip' length 3515244 bytes (3.4 MB)
==================================================
downloaded 3.4 MB


The downloaded binary packages are in
	/var/folders/r2/9gpxdgg92kz0g7qj6jvvzcl00000gn/T//Rtmpxz6leD/downloaded_packages
> philly$bwadapt <- gwr.fit3$bandwidth
> 
> tm_shape(philly, unit = "mi") +
+     tm_polygons(col = "bwadapt", style = "quantile",palette = "Reds", 
+                 border.alpha = 0, title = "") +
+     tm_scale_bar(breaks = c(0, 1, 2), size = 1, position = c("right", "bottom")) +
+     tm_compass(type = "4star", position = c("left", "top")) + 
+     tm_layout(main.title = "GWR bandwidth",  main.title.size = 0.95, frame = FALSE, legend.outside = TRUE)
Error in tm_shape(philly, unit = "mi") : 
  could not find function "tm_shape"
> library(tmap)
> philly$bwadapt <- gwr.fit3$bandwidth
> 
> tm_shape(philly, unit = "mi") +
+     tm_polygons(col = "bwadapt", style = "quantile",palette = "Reds", 
+                 border.alpha = 0, title = "") +
+     tm_scale_bar(breaks = c(0, 1, 2), size = 1, position = c("right", "bottom")) +
+     tm_compass(type = "4star", position = c("left", "top")) + 
+     tm_layout(main.title = "GWR bandwidth",  main.title.size = 0.95, frame = FALSE, legend.outside = TRUE)
Warning message:
The argument size of tm_scale_bar is deprecated. It has been renamed to text.size 
> names(gwr.fit3$SDF)
 [1] "sum.w"               "X.Intercept."        "lmhhinc"            
 [4] "lpop"                "pnhblk"              "punemp"             
 [7] "pvac"                "ph70"                "lmhval"             
[10] "phnew"               "phisp"               "X.Intercept._se"    
[13] "lmhhinc_se"          "lpop_se"             "pnhblk_se"          
[16] "punemp_se"           "pvac_se"             "ph70_se"            
[19] "lmhval_se"           "phnew_se"            "phisp_se"           
[22] "gwr.e"               "pred"                "pred.se"            
[25] "localR2"             "X.Intercept._se_EDF" "lmhhinc_se_EDF"     
[28] "lpop_se_EDF"         "pnhblk_se_EDF"       "punemp_se_EDF"      
[31] "pvac_se_EDF"         "ph70_se_EDF"         "lmhval_se_EDF"      
[34] "phnew_se_EDF"        "phisp_se_EDF"        "pred.se.1"          
> dfree<-gwr.fit3$results$edf
> 
